FROM debian:bookworm-slim AS builder
WORKDIR /app
RUN apt update \
    && apt upgrade \
    && apt install -y \ 
        cmake \
        make \
        python3 \
        python3-pip \
        python3-venv \
        g++ \
        gcc
COPY ./Makefile         /app/Makefile
COPY ./conanfile.txt    /app/conanfile.txt
COPY ./requirements.txt /app/requirements.txt
COPY ./conanprofile.txt /root/.conan2/profiles/default
RUN make install_deps
COPY ./bot /app/bot
RUN make build_bot

FROM debian:bookworm-slim
WORKDIR /app
COPY --from=builder /app/.build/bot/KEBER_BOT ./run
RUN chmod +x ./run
CMD ./run
   